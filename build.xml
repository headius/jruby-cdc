<?xml version="1.0" encoding="UTF-8"?>
<project basedir="." default="all" name="JRuby">
    <target name="init">
        <property name="version" value="0.1.6b"/>
        <property name="version.file" value="0_1_6b"/>
    </target>

    <target depends="init" name="compile">
        <javac debug="true" deprecation="true" destdir="." srcdir=".">
        </javac>
    </target>

    <target depends="init,compile" name="jar">
        <jar basedir="." compress="true" jarfile="jruby.jar" manifest="jruby.mf">
            <exclude name="**/*.java"/>
            <exclude name="**/*.form"/>
            <exclude name="jruby.mf"/>
            <exclude name="*.jar"/>
            <exclude name="*.tar"/>
            <exclude name="*.tar.gz"/>
            <exclude name="test.rb"/>
            <exclude name="java.rb"/>
            <exclude name="build.xml"/>
            <exclude name="COPYING"/>
            <exclude name="README"/>
        </jar>
        <tar basedir="." tarfile="jruby.tar">
            <include name="*.jar"/>
            <include name="COPYING"/>
            <include name="README"/>
            <include name="test.rb"/>
            <include name="java.rb"/>
            <include name="samples/**/*"/>
        </tar>
        <gzip src="jruby.tar" zipfile="jruby-${version.file}.tar.gz"/>
        <delete file="jruby.tar"/>
        <delete file="jruby.jar"/>
    </target>

    <target depends="init" name="src-tar">
        <tar basedir="." tarfile="jruby-src.tar">
            <exclude name="**/*.class"/>
            <exclude name="*.jar"/>
            <exclude name="*.tar"/>
            <exclude name="*.tar.gz"/>
        </tar>
        <gzip src="jruby-src.tar" zipfile="jruby-src-${version.file}.tar.gz"/>
        <delete file="jruby-src.tar"/>
    </target>

    <target depends="init,jar,src-tar" description="Build everything." name="all">
        <echo message="JRuby built."/>
    </target>

    <target depends="init" description="Clean all build products." name="clean">
        <delete>
            <fileset dir=".">
                <include name="**/*.class"/>
                <include name="*.jar"/>
                <include name="*.tar.gz"/>
            </fileset>
        </delete>
    </target>
</project>
